{
  "hook_question": "发布-订阅系统中，如何保证'事件传输安全'和'订阅权限控制'？",
  "support_knowledge": "事件传输安全",
  "knowledge_type": "技术方案类",
  "role_in_hook": "解决传输层安全问题，是钩子问题的第一部分",
  
  "structure": {
    "总": {
      "内容指导": "描述Pub/Sub传输过程中面临的安全威胁",
      "组织要求": "先画出消息传输路径（发布者→事件总线→订阅者），再指出每段路径的威胁点"
    },
    
    "分类维度": {
      "切入口": "按威胁类型分类（窃听、篡改）",
      "排序依据": "按攻击难度递进：窃听（被动攻击，较易）→ 篡改（主动攻击，较难）",
      "说明": "已尝试识别逻辑关系，确实是分类，按攻击难度排序"
    },
    
    "方案1_防窃听": {
      "内部组织": "递进关系：基础方案→进阶方案",
      "递进依据": "按信任边界扩展：信任中间件→不信任中间件",
      "子方案结构": {
        "子方案A": {
          "机制": "需要说明保护的是什么（通道vs消息）",
          "效果": "解决什么威胁",
          "代价": "有什么限制",
          "缓解": "如何降低代价",
          "场景": "什么时候用"
        },
        "子方案B": {
          "机制": "与子方案A的核心差异是什么",
          "效果": "解决子方案A无法覆盖的什么场景",
          "代价": "引入什么新问题（重点：对Pub/Sub功能的影响）",
          "缓解": "如何降低代价",
          "场景": "什么时候需要用这个而不是子方案A"
        }
      }
    },
    
    "方案2_防篡改": {
      "内部组织": "机制闭环（单一方案深入讲解）",
      "闭环要求": {
        "输入": "什么触发签名过程",
        "处理": "签名的具体步骤（发布者侧）",
        "输出": "产生什么（消息+签名）",
        "验证": "订阅者如何验证（验证步骤+失败处理）"
      },
      "机制链条": {
        "机制": "签名的核心原理（不需要讲算法细节，讲清楚为什么能防篡改）",
        "效果": "保证什么",
        "代价": "计算开销、密钥管理",
        "缓解": "如何降低代价",
        "场景": "什么时候需要签名"
      }
    },
    
    "组合策略": {
      "内部组织": "决策关系：场景→选择→理由",
      "决策结构": {
        "常规场景": "条件是什么 → 选择什么组合 → 为什么",
        "高安全场景": "条件是什么 → 选择什么组合 → 为什么"
      }
    }
  },
  
  "prerequisite_concepts": {
    "TLS/SSL": "学生已了解大体概念，教学时确认理解程度后决定补充深度",
    "哈希/签名": "学生不了解，需要先用类比建立直觉再讲机制"
  },
  
  "verification_design": {
    "L1_direction": "机制的保护对象和作用范围",
    "L2_direction": "为什么某机制有某代价（因果链）",
    "L3_direction": "场景选择（条件→选择→理由）",
    "answer_form_check": "避免'两种方案分别是什么'，使用'为什么常规场景选择X而不是Y'"
  },
  
  "bridging": {
    "方向": "从传输层安全过渡到应用层安全",
    "过渡逻辑": "传输安全解决了'消息在路上的安全'，但没解决'谁有权限订阅'"
  },
  
  "transition_to_next": {
    "next_knowledge": "订阅权限控制",
    "relationship": "递进：传输层→应用层"
  },
  
  "risk_points": [
    {"risk": "并列列举防窃听的两个方案", "prevention": "说明递进关系和递进依据"},
    {"risk": "签名机制不闭环", "prevention": "检查输入→处理→输出→验证是否完整"},
    {"risk": "代价无缓解", "prevention": "每个代价配缓解方式"},
    {"risk": "组合策略变成并列", "prevention": "用决策结构：条件→选择→理由"}
  ],
  
  "content_verification_notes": "教学时需要查证：TLS在Pub/Sub中的具体应用方式、消息签名的常用算法"
}
