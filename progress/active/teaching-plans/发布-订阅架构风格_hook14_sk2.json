{
  "hook_question": "发布-订阅系统中，如何保证'事件传输安全'和'订阅权限控制'？",
  "support_knowledge": "订阅权限控制",
  "knowledge_type": "技术方案类",
  "role_in_hook": "解决'谁能订阅什么主题'的问题，是安全保障的第二层（应用层）",
  
  "structure": {
    "organization": "按权限控制的两个阶段分类：认证（你是谁）→ 授权（你能做什么）",
    "section_1_认证机制": {
      "逻辑关系": "递进关系：简单→复杂",
      "排序依据": "按安全强度递进",
      "内容": ["用户名密码", "证书认证", "Token认证（JWT）"],
      "说明": "从最简单的方案讲起，逐步引入更安全的方案"
    },
    "section_2_授权模型": {
      "逻辑关系": "递进关系：粗粒度→细粒度",
      "排序依据": "按控制粒度递进",
      "内容": ["ACL（访问控制列表）", "RBAC（基于角色）", "ABAC（基于属性）"],
      "说明": "从最简单的ACL讲起，说明为什么需要更复杂的模型"
    },
    "section_3_Pub/Sub特有挑战": {
      "逻辑关系": "问题→解决方案",
      "内容": ["动态订阅的权限检查时机", "主题层级的权限继承", "多租户隔离"],
      "说明": "Pub/Sub与传统请求-响应模式在权限控制上的差异"
    }
  },
  
  "prerequisite_concepts": {
    "认证vs授权": "学生可能混淆，需要先区分",
    "JWT": "学生不了解，需要讲解基本结构",
    "RBAC/ABAC": "学生不了解，需要从ACL讲起建立递进理解"
  },
  
  "verification_design": {
    "L1_direction": "认证和授权的区别是什么？RBAC和ABAC的核心差异是什么？",
    "L2_direction": "为什么Pub/Sub的动态订阅给权限控制带来挑战？为什么RBAC不够用需要ABAC？",
    "L3_direction": "什么场景下选择RBAC？什么场景下需要ABAC？",
    "pre_embed_hints": ["认证=身份验证，授权=权限检查", "动态订阅意味着权限检查不能只在启动时做", "主题层级如order.*需要考虑继承"],
    "answer_form_check": "避免问'三种授权模型分别是什么'，改为问'为什么从ACL演进到RBAC再到ABAC'"
  },
  
  "bridging": "传输安全+权限控制共同构成Pub/Sub的安全保障体系",
  
  "transition_to_next": {
    "next_knowledge": "钩子问题15：事件总线节点故障时的消息可靠性",
    "relationship": "从安全性转向容错性，都是分布式环境的关键保障"
  },
  
  "risk_points": [
    {"risk": "并列列举三种认证方式", "prevention": "按安全强度递进排序"},
    {"risk": "并列列举三种授权模型", "prevention": "按控制粒度递进排序，说明演进原因"},
    {"risk": "只讲通用权限控制，不讲Pub/Sub特有挑战", "prevention": "专门一节讲Pub/Sub的特殊性"}
  ],
  
  "content_verification_notes": "JWT结构、RBAC/ABAC的标准定义需要验证来源"
}
